const html = `<div hidden id="productCardList2-js-7863319232699"
  data-product-variants='[{&quot;id&quot;:44700529819835,&quot;title&quot;:&quot;Near Mint&quot;,&quot;option1&quot;:&quot;Near Mint&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-NF-1&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Near Mint&quot;,&quot;public_title&quot;:&quot;Near Mint&quot;,&quot;options&quot;:[&quot;Near Mint&quot;],&quot;price&quot;:200,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700529852603,&quot;title&quot;:&quot;Lightly Played&quot;,&quot;option1&quot;:&quot;Lightly Played&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-NF-2&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Lightly Played&quot;,&quot;public_title&quot;:&quot;Lightly Played&quot;,&quot;options&quot;:[&quot;Lightly Played&quot;],&quot;price&quot;:200,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700529885371,&quot;title&quot;:&quot;Moderately Played&quot;,&quot;option1&quot;:&quot;Moderately Played&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-NF-3&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Moderately Played&quot;,&quot;public_title&quot;:&quot;Moderately Played&quot;,&quot;options&quot;:[&quot;Moderately Played&quot;],&quot;price&quot;:200,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700529918139,&quot;title&quot;:&quot;Heavily Played&quot;,&quot;option1&quot;:&quot;Heavily Played&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-NF-4&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Heavily Played&quot;,&quot;public_title&quot;:&quot;Heavily Played&quot;,&quot;options&quot;:[&quot;Heavily Played&quot;],&quot;price&quot;:200,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700529950907,&quot;title&quot;:&quot;Damaged&quot;,&quot;option1&quot;:&quot;Damaged&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-NF-5&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Damaged&quot;,&quot;public_title&quot;:&quot;Damaged&quot;,&quot;options&quot;:[&quot;Damaged&quot;],&quot;price&quot;:150,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700529983675,&quot;title&quot;:&quot;Near Mint Foil&quot;,&quot;option1&quot;:&quot;Near Mint Foil&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-FO-1&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:true,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Near Mint Foil&quot;,&quot;public_title&quot;:&quot;Near Mint Foil&quot;,&quot;options&quot;:[&quot;Near Mint Foil&quot;],&quot;price&quot;:400,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700530016443,&quot;title&quot;:&quot;Lightly Played Foil&quot;,&quot;option1&quot;:&quot;Lightly Played Foil&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-FO-2&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Lightly Played Foil&quot;,&quot;public_title&quot;:&quot;Lightly Played Foil&quot;,&quot;options&quot;:[&quot;Lightly Played Foil&quot;],&quot;price&quot;:400,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700530049211,&quot;title&quot;:&quot;Moderately Played Foil&quot;,&quot;option1&quot;:&quot;Moderately Played Foil&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-FO-3&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Moderately Played Foil&quot;,&quot;public_title&quot;:&quot;Moderately Played Foil&quot;,&quot;options&quot;:[&quot;Moderately Played Foil&quot;],&quot;price&quot;:400,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700530081979,&quot;title&quot;:&quot;Heavily Played Foil&quot;,&quot;option1&quot;:&quot;Heavily Played Foil&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-FO-4&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Heavily Played Foil&quot;,&quot;public_title&quot;:&quot;Heavily Played Foil&quot;,&quot;options&quot;:[&quot;Heavily Played Foil&quot;],&quot;price&quot;:350,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]},{&quot;id&quot;:44700530114747,&quot;title&quot;:&quot;Damaged Foil&quot;,&quot;option1&quot;:&quot;Damaged Foil&quot;,&quot;option2&quot;:null,&quot;option3&quot;:null,&quot;sku&quot;:&quot;CMM-642-EN-FO-5&quot;,&quot;requires_shipping&quot;:true,&quot;taxable&quot;:true,&quot;featured_image&quot;:null,&quot;available&quot;:false,&quot;name&quot;:&quot;Faithless Looting (Borderless Alternate Art) [Commander Masters] - Damaged Foil&quot;,&quot;public_title&quot;:&quot;Damaged Foil&quot;,&quot;options&quot;:[&quot;Damaged Foil&quot;],&quot;price&quot;:300,&quot;weight&quot;:2,&quot;compare_at_price&quot;:null,&quot;inventory_management&quot;:&quot;shopify&quot;,&quot;barcode&quot;:null,&quot;requires_selling_plan&quot;:false,&quot;selling_plan_allocations&quot;:[]}]'
  data-product-tags='[&quot;Brawl&quot;,&quot;Commander&quot;,&quot;Commander Masters&quot;,&quot;Common&quot;,&quot;Duel&quot;,&quot;Foil&quot;,&quot;Gladiator&quot;,&quot;Historic&quot;,&quot;Legacy&quot;,&quot;Modern&quot;,&quot;Normal&quot;,&quot;Oathbreaker&quot;,&quot;Pauper&quot;,&quot;Paupercommander&quot;,&quot;Red&quot;,&quot;Sorcery&quot;,&quot;Timeless&quot;,&quot;Vintage&quot;]'
  data-product-type='MTG Single'
  data-product-id='7863319232699'
  data-collection='null'
  data-product-collection-titles='[&quot;MTG Singles - All Products&quot;,&quot;MTG Singles - Instock&quot;,&quot;New Arrivals&quot;]'
  data-initial-variant='44700529983675'
  data-sold-out='SOLD OUT'
  data-back-order='BACKORDER'
  data-pre-order='PREORDER'
></div>`

import * as cheerio from "cheerio";
import { parse } from "path";


function parseProductVariants(html) {
  // Load the HTML into Cheerio
  const $ = cheerio.load(html);

  // Find the div with the `data-product-variants` attribute
  const productDiv = $("div[data-product-variants]");
  if (!productDiv.length) {
    console.error("No product variants found in the HTML.");
    return [];
  }

  // Get the `data-product-variants` attribute and parse it as JSON
  const productVariantsRaw = productDiv.attr("data-product-variants");
  if (!productVariantsRaw) {
    console.error("No product variants data found.");
    return [];
  }

  let productVariants = [];
  try {
    productVariants = JSON.parse(productVariantsRaw.replace(/&quot;/g, '"'));
  } catch (error) {
    console.error("Error parsing product variants:", error);
    return [];
  }

  // Map the product variants to return only the necessary details
  return productVariants.map((variant) => ({
    id: variant.id,
    title: variant.title,
    price: variant.price / 100, // Assuming price is in cents, convert to dollars
    available: variant.available,
    name: variant.name,
  }));
}


function parseCardString(cardString) {
  const pattern = /^(.*?)\s*(?:\((.*?)\))?\s*\[(.*?)\]\s*-\s*(.+)$/;
  const match = cardString.match(pattern);
  const conditions = ["Damaged", "Near Mint", "Lightly Played", "Moderately Played", "Heavily Played"];

  if (!match) {
    throw new Error("Invalid string format");
  }

  // Extract the components with defaults
  const [_, cardName, details = "", setName, conditionRaw] = match;
  let condition = "";
  for (let i = 0; i < conditions.length; i++) {
    if (conditionRaw.trim().includes(conditions[i])) {
      condition = conditions[i];
      break;
    }
  }
  
  const finish = conditionRaw.trim().replace(condition, "").trim();
  return [cardName.trim(), details.trim(), setName.trim(), condition, finish];
}


const json = parseCardString('Counterspell (Japanese Foil Etched) [Strixhaven: School of Mages Mystical Archive] - Damaged Foil')
console.log(json)